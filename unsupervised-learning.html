<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Unsupervised Learning | An Introduction to Statistical Learning</title>
  <meta name="description" content="12 Unsupervised Learning | An Introduction to Statistical Learning" />
  <meta name="generator" content="bookdown 0.41.2 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Unsupervised Learning | An Introduction to Statistical Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="danhalligan/ISLRv2-solutions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Unsupervised Learning | An Introduction to Statistical Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="survival-analysis-and-censored-data.html"/>
<link rel="next" href="multiple-testing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="islrv2.css" type="text/css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aaaakshat/cm-web-fonts@latest/fonts.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ISLRv2 Solutions</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="statistical-learning.html"><a href="statistical-learning.html"><i class="fa fa-check"></i><b>2</b> Statistical Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#conceptual"><i class="fa fa-check"></i><b>2.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-learning.html"><a href="statistical-learning.html#question-1"><i class="fa fa-check"></i><b>2.1.1</b> Question 1</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistical-learning.html"><a href="statistical-learning.html#question-2"><i class="fa fa-check"></i><b>2.1.2</b> Question 2</a></li>
<li class="chapter" data-level="2.1.3" data-path="statistical-learning.html"><a href="statistical-learning.html#question-3"><i class="fa fa-check"></i><b>2.1.3</b> Question 3</a></li>
<li class="chapter" data-level="2.1.4" data-path="statistical-learning.html"><a href="statistical-learning.html#question-4"><i class="fa fa-check"></i><b>2.1.4</b> Question 4</a></li>
<li class="chapter" data-level="2.1.5" data-path="statistical-learning.html"><a href="statistical-learning.html#question-5"><i class="fa fa-check"></i><b>2.1.5</b> Question 5</a></li>
<li class="chapter" data-level="2.1.6" data-path="statistical-learning.html"><a href="statistical-learning.html#question-6"><i class="fa fa-check"></i><b>2.1.6</b> Question 6</a></li>
<li class="chapter" data-level="2.1.7" data-path="statistical-learning.html"><a href="statistical-learning.html#question-7"><i class="fa fa-check"></i><b>2.1.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#applied"><i class="fa fa-check"></i><b>2.2</b> Applied</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#question-8"><i class="fa fa-check"></i><b>2.2.1</b> Question 8</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#question-9"><i class="fa fa-check"></i><b>2.2.2</b> Question 9</a></li>
<li class="chapter" data-level="2.2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#question-10"><i class="fa fa-check"></i><b>2.2.3</b> Question 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#conceptual-1"><i class="fa fa-check"></i><b>3.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="linear-regression.html"><a href="linear-regression.html#question-1-1"><i class="fa fa-check"></i><b>3.1.1</b> Question 1</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-regression.html"><a href="linear-regression.html#question-2-1"><i class="fa fa-check"></i><b>3.1.2</b> Question 2</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-regression.html"><a href="linear-regression.html#question-3-1"><i class="fa fa-check"></i><b>3.1.3</b> Question 3</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-regression.html"><a href="linear-regression.html#question-4-1"><i class="fa fa-check"></i><b>3.1.4</b> Question 4</a></li>
<li class="chapter" data-level="3.1.5" data-path="linear-regression.html"><a href="linear-regression.html#question-5-1"><i class="fa fa-check"></i><b>3.1.5</b> Question 5</a></li>
<li class="chapter" data-level="3.1.6" data-path="linear-regression.html"><a href="linear-regression.html#question-6-1"><i class="fa fa-check"></i><b>3.1.6</b> Question 6</a></li>
<li class="chapter" data-level="3.1.7" data-path="linear-regression.html"><a href="linear-regression.html#question-7-1"><i class="fa fa-check"></i><b>3.1.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#applied-1"><i class="fa fa-check"></i><b>3.2</b> Applied</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#question-8-1"><i class="fa fa-check"></i><b>3.2.1</b> Question 8</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-regression.html"><a href="linear-regression.html#question-9-1"><i class="fa fa-check"></i><b>3.2.2</b> Question 9</a></li>
<li class="chapter" data-level="3.2.3" data-path="linear-regression.html"><a href="linear-regression.html#question-10-1"><i class="fa fa-check"></i><b>3.2.3</b> Question 10</a></li>
<li class="chapter" data-level="3.2.4" data-path="linear-regression.html"><a href="linear-regression.html#question-11"><i class="fa fa-check"></i><b>3.2.4</b> Question 11</a></li>
<li class="chapter" data-level="3.2.5" data-path="linear-regression.html"><a href="linear-regression.html#question-12"><i class="fa fa-check"></i><b>3.2.5</b> Question 12</a></li>
<li class="chapter" data-level="3.2.6" data-path="linear-regression.html"><a href="linear-regression.html#question-13"><i class="fa fa-check"></i><b>3.2.6</b> Question 13</a></li>
<li class="chapter" data-level="3.2.7" data-path="linear-regression.html"><a href="linear-regression.html#question-14"><i class="fa fa-check"></i><b>3.2.7</b> Question 14</a></li>
<li class="chapter" data-level="3.2.8" data-path="linear-regression.html"><a href="linear-regression.html#question-15"><i class="fa fa-check"></i><b>3.2.8</b> Question 15</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>4</b> Classification</a>
<ul>
<li class="chapter" data-level="4.1" data-path="classification.html"><a href="classification.html#conceptual-2"><i class="fa fa-check"></i><b>4.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="classification.html"><a href="classification.html#question-1-2"><i class="fa fa-check"></i><b>4.1.1</b> Question 1</a></li>
<li class="chapter" data-level="4.1.2" data-path="classification.html"><a href="classification.html#question-2-2"><i class="fa fa-check"></i><b>4.1.2</b> Question 2</a></li>
<li class="chapter" data-level="4.1.3" data-path="classification.html"><a href="classification.html#question-3-2"><i class="fa fa-check"></i><b>4.1.3</b> Question 3</a></li>
<li class="chapter" data-level="4.1.4" data-path="classification.html"><a href="classification.html#question-4-2"><i class="fa fa-check"></i><b>4.1.4</b> Question 4</a></li>
<li class="chapter" data-level="4.1.5" data-path="classification.html"><a href="classification.html#question-5-2"><i class="fa fa-check"></i><b>4.1.5</b> Question 5</a></li>
<li class="chapter" data-level="4.1.6" data-path="classification.html"><a href="classification.html#question-6-2"><i class="fa fa-check"></i><b>4.1.6</b> Question 6</a></li>
<li class="chapter" data-level="4.1.7" data-path="classification.html"><a href="classification.html#question-7-2"><i class="fa fa-check"></i><b>4.1.7</b> Question 7</a></li>
<li class="chapter" data-level="4.1.8" data-path="classification.html"><a href="classification.html#question-8-2"><i class="fa fa-check"></i><b>4.1.8</b> Question 8</a></li>
<li class="chapter" data-level="4.1.9" data-path="classification.html"><a href="classification.html#question-9-2"><i class="fa fa-check"></i><b>4.1.9</b> Question 9</a></li>
<li class="chapter" data-level="4.1.10" data-path="classification.html"><a href="classification.html#question-10-2"><i class="fa fa-check"></i><b>4.1.10</b> Question 10</a></li>
<li class="chapter" data-level="4.1.11" data-path="classification.html"><a href="classification.html#question-11-1"><i class="fa fa-check"></i><b>4.1.11</b> Question 11</a></li>
<li class="chapter" data-level="4.1.12" data-path="classification.html"><a href="classification.html#question-12-1"><i class="fa fa-check"></i><b>4.1.12</b> Question 12</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="classification.html"><a href="classification.html#applied-2"><i class="fa fa-check"></i><b>4.2</b> Applied</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="classification.html"><a href="classification.html#question-13-1"><i class="fa fa-check"></i><b>4.2.1</b> Question 13</a></li>
<li class="chapter" data-level="4.2.2" data-path="classification.html"><a href="classification.html#question-14-1"><i class="fa fa-check"></i><b>4.2.2</b> Question 14</a></li>
<li class="chapter" data-level="4.2.3" data-path="classification.html"><a href="classification.html#question-15-1"><i class="fa fa-check"></i><b>4.2.3</b> Question 15</a></li>
<li class="chapter" data-level="4.2.4" data-path="classification.html"><a href="classification.html#question-13-2"><i class="fa fa-check"></i><b>4.2.4</b> Question 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="resampling-methods.html"><a href="resampling-methods.html"><i class="fa fa-check"></i><b>5</b> Resampling Methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="resampling-methods.html"><a href="resampling-methods.html#conceptual-3"><i class="fa fa-check"></i><b>5.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="resampling-methods.html"><a href="resampling-methods.html#question-1-3"><i class="fa fa-check"></i><b>5.1.1</b> Question 1</a></li>
<li class="chapter" data-level="5.1.2" data-path="resampling-methods.html"><a href="resampling-methods.html#question-2-3"><i class="fa fa-check"></i><b>5.1.2</b> Question 2</a></li>
<li class="chapter" data-level="5.1.3" data-path="resampling-methods.html"><a href="resampling-methods.html#question-3-3"><i class="fa fa-check"></i><b>5.1.3</b> Question 3</a></li>
<li class="chapter" data-level="5.1.4" data-path="resampling-methods.html"><a href="resampling-methods.html#question-4-3"><i class="fa fa-check"></i><b>5.1.4</b> Question 4</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="resampling-methods.html"><a href="resampling-methods.html#applied-3"><i class="fa fa-check"></i><b>5.2</b> Applied</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="resampling-methods.html"><a href="resampling-methods.html#question-5-3"><i class="fa fa-check"></i><b>5.2.1</b> Question 5</a></li>
<li class="chapter" data-level="5.2.2" data-path="resampling-methods.html"><a href="resampling-methods.html#question-6-3"><i class="fa fa-check"></i><b>5.2.2</b> Question 6</a></li>
<li class="chapter" data-level="5.2.3" data-path="resampling-methods.html"><a href="resampling-methods.html#question-7-3"><i class="fa fa-check"></i><b>5.2.3</b> Question 7</a></li>
<li class="chapter" data-level="5.2.4" data-path="resampling-methods.html"><a href="resampling-methods.html#question-8-3"><i class="fa fa-check"></i><b>5.2.4</b> Question 8</a></li>
<li class="chapter" data-level="5.2.5" data-path="resampling-methods.html"><a href="resampling-methods.html#question-9-3"><i class="fa fa-check"></i><b>5.2.5</b> Question 9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html"><i class="fa fa-check"></i><b>6</b> Linear Model Selection and Regularization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#conceptual-4"><i class="fa fa-check"></i><b>6.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-1-4"><i class="fa fa-check"></i><b>6.1.1</b> Question 1</a></li>
<li class="chapter" data-level="6.1.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-2-4"><i class="fa fa-check"></i><b>6.1.2</b> Question 2</a></li>
<li class="chapter" data-level="6.1.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-3-4"><i class="fa fa-check"></i><b>6.1.3</b> Question 3</a></li>
<li class="chapter" data-level="6.1.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-4-4"><i class="fa fa-check"></i><b>6.1.4</b> Question 4</a></li>
<li class="chapter" data-level="6.1.5" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-5-4"><i class="fa fa-check"></i><b>6.1.5</b> Question 5</a></li>
<li class="chapter" data-level="6.1.6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-6-4"><i class="fa fa-check"></i><b>6.1.6</b> Question 6</a></li>
<li class="chapter" data-level="6.1.7" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-7-4"><i class="fa fa-check"></i><b>6.1.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#applied-4"><i class="fa fa-check"></i><b>6.2</b> Applied</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-8-4"><i class="fa fa-check"></i><b>6.2.1</b> Question 8</a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-9-4"><i class="fa fa-check"></i><b>6.2.2</b> Question 9</a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-10-3"><i class="fa fa-check"></i><b>6.2.3</b> Question 10</a></li>
<li class="chapter" data-level="6.2.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-11-2"><i class="fa fa-check"></i><b>6.2.4</b> Question 11</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html"><i class="fa fa-check"></i><b>7</b> Moving Beyond Linearity</a>
<ul>
<li class="chapter" data-level="7.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#conceptual-5"><i class="fa fa-check"></i><b>7.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-1-5"><i class="fa fa-check"></i><b>7.1.1</b> Question 1</a></li>
<li class="chapter" data-level="7.1.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-2-5"><i class="fa fa-check"></i><b>7.1.2</b> Question 2</a></li>
<li class="chapter" data-level="7.1.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-3-5"><i class="fa fa-check"></i><b>7.1.3</b> Question 3</a></li>
<li class="chapter" data-level="7.1.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-4-5"><i class="fa fa-check"></i><b>7.1.4</b> Question 4</a></li>
<li class="chapter" data-level="7.1.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-5-5"><i class="fa fa-check"></i><b>7.1.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#applied-5"><i class="fa fa-check"></i><b>7.2</b> Applied</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-6-5"><i class="fa fa-check"></i><b>7.2.1</b> Question 6</a></li>
<li class="chapter" data-level="7.2.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-7-5"><i class="fa fa-check"></i><b>7.2.2</b> Question 7</a></li>
<li class="chapter" data-level="7.2.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-8-5"><i class="fa fa-check"></i><b>7.2.3</b> Question 8</a></li>
<li class="chapter" data-level="7.2.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-9-5"><i class="fa fa-check"></i><b>7.2.4</b> Question 9</a></li>
<li class="chapter" data-level="7.2.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-10-4"><i class="fa fa-check"></i><b>7.2.5</b> Question 10</a></li>
<li class="chapter" data-level="7.2.6" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-11-3"><i class="fa fa-check"></i><b>7.2.6</b> Question 11</a></li>
<li class="chapter" data-level="7.2.7" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-12-2"><i class="fa fa-check"></i><b>7.2.7</b> Question 12</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tree-based-methods.html"><a href="tree-based-methods.html"><i class="fa fa-check"></i><b>8</b> Tree-Based Methods</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#conceptual-6"><i class="fa fa-check"></i><b>8.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-1-6"><i class="fa fa-check"></i><b>8.1.1</b> Question 1</a></li>
<li class="chapter" data-level="8.1.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-2-6"><i class="fa fa-check"></i><b>8.1.2</b> Question 2</a></li>
<li class="chapter" data-level="8.1.3" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-3-6"><i class="fa fa-check"></i><b>8.1.3</b> Question 3</a></li>
<li class="chapter" data-level="8.1.4" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-4-6"><i class="fa fa-check"></i><b>8.1.4</b> Question 4</a></li>
<li class="chapter" data-level="8.1.5" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-5-6"><i class="fa fa-check"></i><b>8.1.5</b> Question 5</a></li>
<li class="chapter" data-level="8.1.6" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-6-6"><i class="fa fa-check"></i><b>8.1.6</b> Question 6</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#applied-6"><i class="fa fa-check"></i><b>8.2</b> Applied</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-7-6"><i class="fa fa-check"></i><b>8.2.1</b> Question 7</a></li>
<li class="chapter" data-level="8.2.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-8-6"><i class="fa fa-check"></i><b>8.2.2</b> Question 8</a></li>
<li class="chapter" data-level="8.2.3" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-9-6"><i class="fa fa-check"></i><b>8.2.3</b> Question 9</a></li>
<li class="chapter" data-level="8.2.4" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-10-5"><i class="fa fa-check"></i><b>8.2.4</b> Question 10</a></li>
<li class="chapter" data-level="8.2.5" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-11-4"><i class="fa fa-check"></i><b>8.2.5</b> Question 11</a></li>
<li class="chapter" data-level="8.2.6" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-12-3"><i class="fa fa-check"></i><b>8.2.6</b> Question 12</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>9</b> Support Vector Machines</a>
<ul>
<li class="chapter" data-level="9.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#conceptual-7"><i class="fa fa-check"></i><b>9.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-1-7"><i class="fa fa-check"></i><b>9.1.1</b> Question 1</a></li>
<li class="chapter" data-level="9.1.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-2-7"><i class="fa fa-check"></i><b>9.1.2</b> Question 2</a></li>
<li class="chapter" data-level="9.1.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-3-7"><i class="fa fa-check"></i><b>9.1.3</b> Question 3</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#applied-7"><i class="fa fa-check"></i><b>9.2</b> Applied</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-4-7"><i class="fa fa-check"></i><b>9.2.1</b> Question 4</a></li>
<li class="chapter" data-level="9.2.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-5-7"><i class="fa fa-check"></i><b>9.2.2</b> Question 5</a></li>
<li class="chapter" data-level="9.2.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-6-7"><i class="fa fa-check"></i><b>9.2.3</b> Question 6</a></li>
<li class="chapter" data-level="9.2.4" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-7-7"><i class="fa fa-check"></i><b>9.2.4</b> Question 7</a></li>
<li class="chapter" data-level="9.2.5" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-8-7"><i class="fa fa-check"></i><b>9.2.5</b> Question 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>10</b> Deep Learning</a>
<ul>
<li class="chapter" data-level="10.1" data-path="deep-learning.html"><a href="deep-learning.html#conceptual-8"><i class="fa fa-check"></i><b>10.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="deep-learning.html"><a href="deep-learning.html#question-1-8"><i class="fa fa-check"></i><b>10.1.1</b> Question 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="deep-learning.html"><a href="deep-learning.html#question-2-8"><i class="fa fa-check"></i><b>10.1.2</b> Question 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="deep-learning.html"><a href="deep-learning.html#question-3-8"><i class="fa fa-check"></i><b>10.1.3</b> Question 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="deep-learning.html"><a href="deep-learning.html#question-4-8"><i class="fa fa-check"></i><b>10.1.4</b> Question 4</a></li>
<li class="chapter" data-level="10.1.5" data-path="deep-learning.html"><a href="deep-learning.html#question-5-8"><i class="fa fa-check"></i><b>10.1.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="deep-learning.html"><a href="deep-learning.html#applied-8"><i class="fa fa-check"></i><b>10.2</b> Applied</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="deep-learning.html"><a href="deep-learning.html#question-6-8"><i class="fa fa-check"></i><b>10.2.1</b> Question 6</a></li>
<li class="chapter" data-level="10.2.2" data-path="deep-learning.html"><a href="deep-learning.html#question-7-8"><i class="fa fa-check"></i><b>10.2.2</b> Question 7</a></li>
<li class="chapter" data-level="10.2.3" data-path="deep-learning.html"><a href="deep-learning.html#question-8-8"><i class="fa fa-check"></i><b>10.2.3</b> Question 8</a></li>
<li class="chapter" data-level="10.2.4" data-path="deep-learning.html"><a href="deep-learning.html#question-9-7"><i class="fa fa-check"></i><b>10.2.4</b> Question 9</a></li>
<li class="chapter" data-level="10.2.5" data-path="deep-learning.html"><a href="deep-learning.html#question-10-6"><i class="fa fa-check"></i><b>10.2.5</b> Question 10</a></li>
<li class="chapter" data-level="10.2.6" data-path="deep-learning.html"><a href="deep-learning.html#question-11-5"><i class="fa fa-check"></i><b>10.2.6</b> Question 11</a></li>
<li class="chapter" data-level="10.2.7" data-path="deep-learning.html"><a href="deep-learning.html#question-12-4"><i class="fa fa-check"></i><b>10.2.7</b> Question 12</a></li>
<li class="chapter" data-level="10.2.8" data-path="deep-learning.html"><a href="deep-learning.html#question-13-3"><i class="fa fa-check"></i><b>10.2.8</b> Question 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html"><i class="fa fa-check"></i><b>11</b> Survival Analysis and Censored Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#conceptual-9"><i class="fa fa-check"></i><b>11.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-1-9"><i class="fa fa-check"></i><b>11.1.1</b> Question 1</a></li>
<li class="chapter" data-level="11.1.2" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-2-9"><i class="fa fa-check"></i><b>11.1.2</b> Question 2</a></li>
<li class="chapter" data-level="11.1.3" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-3-9"><i class="fa fa-check"></i><b>11.1.3</b> Question 3</a></li>
<li class="chapter" data-level="11.1.4" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-4-9"><i class="fa fa-check"></i><b>11.1.4</b> Question 4</a></li>
<li class="chapter" data-level="11.1.5" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-5-9"><i class="fa fa-check"></i><b>11.1.5</b> Question 5</a></li>
<li class="chapter" data-level="11.1.6" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-6-9"><i class="fa fa-check"></i><b>11.1.6</b> Question 6</a></li>
<li class="chapter" data-level="11.1.7" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-7-9"><i class="fa fa-check"></i><b>11.1.7</b> Question 7</a></li>
<li class="chapter" data-level="11.1.8" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-8-9"><i class="fa fa-check"></i><b>11.1.8</b> Question 8</a></li>
<li class="chapter" data-level="11.1.9" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-9-8"><i class="fa fa-check"></i><b>11.1.9</b> Question 9</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#applied-9"><i class="fa fa-check"></i><b>11.2</b> Applied</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-10-7"><i class="fa fa-check"></i><b>11.2.1</b> Question 10</a></li>
<li class="chapter" data-level="11.2.2" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-11-6"><i class="fa fa-check"></i><b>11.2.2</b> Question 11</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>12</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#conceptual-10"><i class="fa fa-check"></i><b>12.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-1-10"><i class="fa fa-check"></i><b>12.1.1</b> Question 1</a></li>
<li class="chapter" data-level="12.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-2-10"><i class="fa fa-check"></i><b>12.1.2</b> Question 2</a></li>
<li class="chapter" data-level="12.1.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-3-10"><i class="fa fa-check"></i><b>12.1.3</b> Question 3</a></li>
<li class="chapter" data-level="12.1.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-4-10"><i class="fa fa-check"></i><b>12.1.4</b> Question 4</a></li>
<li class="chapter" data-level="12.1.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-5-10"><i class="fa fa-check"></i><b>12.1.5</b> Question 5</a></li>
<li class="chapter" data-level="12.1.6" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-6-10"><i class="fa fa-check"></i><b>12.1.6</b> Question 6</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#applied-10"><i class="fa fa-check"></i><b>12.2</b> Applied</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-7-10"><i class="fa fa-check"></i><b>12.2.1</b> Question 7</a></li>
<li class="chapter" data-level="12.2.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-8-10"><i class="fa fa-check"></i><b>12.2.2</b> Question 8</a></li>
<li class="chapter" data-level="12.2.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-9-9"><i class="fa fa-check"></i><b>12.2.3</b> Question 9</a></li>
<li class="chapter" data-level="12.2.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-10-8"><i class="fa fa-check"></i><b>12.2.4</b> Question 10</a></li>
<li class="chapter" data-level="12.2.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-11-7"><i class="fa fa-check"></i><b>12.2.5</b> Question 11</a></li>
<li class="chapter" data-level="12.2.6" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-12-5"><i class="fa fa-check"></i><b>12.2.6</b> Question 12</a></li>
<li class="chapter" data-level="12.2.7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-13-4"><i class="fa fa-check"></i><b>12.2.7</b> Question 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-testing.html"><a href="multiple-testing.html"><i class="fa fa-check"></i><b>13</b> Multiple Testing</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-testing.html"><a href="multiple-testing.html#conceptual-11"><i class="fa fa-check"></i><b>13.1</b> Conceptual</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="multiple-testing.html"><a href="multiple-testing.html#question-1-11"><i class="fa fa-check"></i><b>13.1.1</b> Question 1</a></li>
<li class="chapter" data-level="13.1.2" data-path="multiple-testing.html"><a href="multiple-testing.html#question-2-11"><i class="fa fa-check"></i><b>13.1.2</b> Question 2</a></li>
<li class="chapter" data-level="13.1.3" data-path="multiple-testing.html"><a href="multiple-testing.html#question-3-11"><i class="fa fa-check"></i><b>13.1.3</b> Question 3</a></li>
<li class="chapter" data-level="13.1.4" data-path="multiple-testing.html"><a href="multiple-testing.html#question-4-11"><i class="fa fa-check"></i><b>13.1.4</b> Question 4</a></li>
<li class="chapter" data-level="13.1.5" data-path="multiple-testing.html"><a href="multiple-testing.html#question-5-11"><i class="fa fa-check"></i><b>13.1.5</b> Question 5</a></li>
<li class="chapter" data-level="13.1.6" data-path="multiple-testing.html"><a href="multiple-testing.html#question-6-11"><i class="fa fa-check"></i><b>13.1.6</b> Question 6</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="multiple-testing.html"><a href="multiple-testing.html#applied-11"><i class="fa fa-check"></i><b>13.2</b> Applied</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="multiple-testing.html"><a href="multiple-testing.html#question-7-11"><i class="fa fa-check"></i><b>13.2.1</b> Question 7</a></li>
<li class="chapter" data-level="13.2.2" data-path="multiple-testing.html"><a href="multiple-testing.html#question-8-11"><i class="fa fa-check"></i><b>13.2.2</b> Question 8</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unsupervised-learning" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Unsupervised Learning<a href="unsupervised-learning.html#unsupervised-learning" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="conceptual-10" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Conceptual<a href="unsupervised-learning.html#conceptual-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-1-10" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Question 1<a href="unsupervised-learning.html#question-1-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>This problem involves the <span class="math inline">\(K\)</span>-means clustering algorithm.</p>
<ol style="list-style-type: lower-alpha">
<li>Prove (12.18).</li>
</ol>
</blockquote>
<p>12.18 is:</p>
<p><span class="math display">\[
\frac{1}{|C_k|}\sum_{i,i&#39; \in C_k} \sum_{j=1}^p (x_{ij} - x_{i&#39;j})^2 =
2 \sum_{i \in C_k} \sum_{j=1}^p  (x_{ij} - \bar{x}_{kj})^2
\]</span></p>
<p>where <span class="math display">\[\bar{x}_{kj} = \frac{1}{|C_k|}\sum_{i \in C_k} x_{ij}\]</span></p>
<p>On the left hand side we compute the difference between each observation
(indexed by <span class="math inline">\(i\)</span> and <span class="math inline">\(i&#39;\)</span>). In the second we compute the difference between
each observation and the mean. Intuitively this identity is clear (the factor
of 2 is present because we calculate the difference between each pair twice).
However, to prove.</p>
<p>Note first that,
<span class="math display">\[\begin{align}
(x_{ij} - x_{i&#39;j})^2
  = &amp; ((x_{ij} - \bar{x}_{kj}) - (x_{i&#39;j} - \bar{x}_{kj}))^2 \\
  = &amp; (x_{ij} - \bar{x}_{kj})^2 -
      2(x_{ij} - \bar{x}_{kj})(x_{i&#39;j} - \bar{x}_{kj}) +
      (x_{i&#39;j} - \bar{x}_{kj})^2
\end{align}\]</span></p>
<p>Note that the first term is independent of <span class="math inline">\(i&#39;\)</span> and the last is independent of
<span class="math inline">\(i\)</span>.</p>
<p>Therefore, 10.12 can be written as:</p>
<p><span class="math display">\[\begin{align}
\frac{1}{|C_k|}\sum_{i,i&#39; \in C_k} \sum_{j=1}^p (x_{ij} - x_{i&#39;j})^2
= &amp; \frac{1}{|C_k|}\sum_{i,i&#39; \in C_k}\sum_{j=1}^p (x_{ij} - \bar{x}_{kj})^2 -
    \frac{1}{|C_k|}\sum_{i,i&#39; \in C_k}\sum_{j=1}^p 2(x_{ij} - \bar{x}_{kj})(x_{i&#39;j} - \bar{x}_{kj}) +
    \frac{1}{|C_k|}\sum_{i,i&#39; \in C_k}\sum_{j=1}^p (x_{i&#39;j} - \bar{x}_{kj})^2 \\
= &amp; \frac{|C_k|}{|C_k|}\sum_{i \in C_k}\sum_{j=1}^p (x_{ij} - \bar{x}_{kj})^2 -
    \frac{2}{|C_k|}\sum_{i,i&#39; \in C_k}\sum_{j=1}^p (x_{ij} - \bar{x}_{kj})(x_{i&#39;j} - \bar{x}_{kj}) +
    \frac{|C_k|}{|C_k|}\sum_{i \in C_k}\sum_{j=1}^p (x_{ij} - \bar{x}_{kj})^2 \\
= &amp; 2 \sum_{i \in C_k}\sum_{j=1}^p (x_{ij} - \bar{x}_{kj})^2
\end{align}\]</span></p>
<p>Note that we can drop the term containing
<span class="math inline">\((x_{ij} - \bar{x}_{kj})(x_{i&#39;j} - \bar{x}_{kj})\)</span> since this is 0 when summed
over combinations of <span class="math inline">\(i\)</span> and <span class="math inline">\(i&#39;\)</span> for a given <span class="math inline">\(j\)</span>.</p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>On the basis of this identity, argue that the <span class="math inline">\(K\)</span>-means clustering
algorithm (Algorithm 12.2) decreases the objective (12.17) at each
iteration.</li>
</ol>
</blockquote>
<p>Equation 10.12 demonstrates that the euclidean distance between each possible
pair of samples can be related to the difference from each sample to the mean
of the cluster. The K-means algorithm works by minimizing the euclidean distance
to each centroid, thus also minimizes the within-cluster variance.</p>
</div>
<div id="question-2-10" class="section level3 hasAnchor" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Question 2<a href="unsupervised-learning.html#question-2-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Suppose that we have four observations, for which we compute a dissimilarity
matrix, given by</p>
<span class="math display">\[\begin{bmatrix}
     &amp; 0.3  &amp; 0.4  &amp; 0.7  \\
0.3  &amp;      &amp; 0.5  &amp; 0.8  \\
0.4  &amp; 0.5  &amp;      &amp; 0.45 \\
0.7  &amp; 0.8  &amp; 0.45 &amp;      \\
\end{bmatrix}\]</span>
<p>For instance, the dissimilarity between the first and second observations is
0.3, and the dissimilarity between the second and fourth observations is 0.8.</p>
<ol style="list-style-type: lower-alpha">
<li>On the basis of this dissimilarity matrix, sketch the dendrogram that
results from hierarchically clustering these four observations using
complete linkage. Be sure to indicate on the plot the height at which each
fusion occurs, as well as the observations corresponding to each leaf in
the dendrogram.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="unsupervised-learning.html#cb768-1" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">0.3</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.</span>, <span class="fl">0.45</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.45</span>, <span class="dv">0</span>), <span class="dt">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb768-2"><a href="unsupervised-learning.html#cb768-2" aria-hidden="true"></a>c1 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">as.dist</span>(m), <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb768-3"><a href="unsupervised-learning.html#cb768-3" aria-hidden="true"></a><span class="kw">plot</span>(c1)</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Repeat (a), this time using single linkage clustering.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="unsupervised-learning.html#cb769-1" aria-hidden="true"></a>c2 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">as.dist</span>(m), <span class="dt">method =</span> <span class="st">&quot;single&quot;</span>)</span>
<span id="cb769-2"><a href="unsupervised-learning.html#cb769-2" aria-hidden="true"></a><span class="kw">plot</span>(c2)</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Suppose that we cut the dendrogram obtained in (a) such that two clusters
result. Which observations are in each cluster?</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="unsupervised-learning.html#cb770-1" aria-hidden="true"></a><span class="kw">table</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">cutree</span>(c1, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##    
##     1 2
##   1 1 0
##   2 1 0
##   3 0 1
##   4 0 1</code></pre>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Suppose that we cut the dendrogram obtained in (b) such that two clusters
result. Which observations are in each cluster?</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="unsupervised-learning.html#cb772-1" aria-hidden="true"></a><span class="kw">table</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">cutree</span>(c2, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##    
##     1 2
##   1 1 0
##   2 1 0
##   3 1 0
##   4 0 1</code></pre>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>It is mentioned in the chapter that at each fusion in the dendrogram, the
position of the two clusters being fused can be swapped without changing
the meaning of the dendrogram. Draw a dendrogram that is equivalent to the
dendrogram in (a), for which two or more of the leaves are repositioned,
but for which the meaning of the dendrogram is the same.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="unsupervised-learning.html#cb774-1" aria-hidden="true"></a><span class="kw">plot</span>(c1, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="question-3-10" class="section level3 hasAnchor" number="12.1.3">
<h3><span class="header-section-number">12.1.3</span> Question 3<a href="unsupervised-learning.html#question-3-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In this problem, you will perform <span class="math inline">\(K\)</span>-means clustering manually, with <span class="math inline">\(K = 2\)</span>,
on a small example with <span class="math inline">\(n = 6\)</span> observations and <span class="math inline">\(p = 2\)</span> features. The
observations are as follows.</p>
<table>
<thead>
<tr class="header">
<th>Obs.</th>
<th><span class="math inline">\(X_1\)</span></th>
<th><span class="math inline">\(X_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>2</td>
</tr>
<tr class="even">
<td>6</td>
<td>4</td>
<td>0</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Plot the observations.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="unsupervised-learning.html#cb775-1" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb775-2"><a href="unsupervised-learning.html#cb775-2" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb775-3"><a href="unsupervised-learning.html#cb775-3" aria-hidden="true"></a>  <span class="dt">x1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>),</span>
<span id="cb775-4"><a href="unsupervised-learning.html#cb775-4" aria-hidden="true"></a>  <span class="dt">x2 =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb775-5"><a href="unsupervised-learning.html#cb775-5" aria-hidden="true"></a>)</span>
<span id="cb775-6"><a href="unsupervised-learning.html#cb775-6" aria-hidden="true"></a><span class="kw">ggplot</span>(d, <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Randomly assign a cluster label to each observation. You can use the
<code>sample()</code> command in <code>R</code> to do this. Report the cluster labels for each
observation.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="unsupervised-learning.html#cb776-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb776-2"><a href="unsupervised-learning.html#cb776-2" aria-hidden="true"></a>d<span class="op">$</span>cluster &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">size =</span> <span class="kw">nrow</span>(d), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Compute the centroid for each cluster.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="unsupervised-learning.html#cb777-1" aria-hidden="true"></a>centroids &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="cf">function</span>(i) <span class="kw">colMeans</span>(d[d<span class="op">$</span>cluster <span class="op">==</span><span class="st"> </span>i, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))</span></code></pre></div>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Assign each observation to the centroid to which it is closest, in terms of
Euclidean distance. Report the cluster labels for each observation.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="unsupervised-learning.html#cb778-1" aria-hidden="true"></a>dist &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="cf">function</span>(i) {</span>
<span id="cb778-2"><a href="unsupervised-learning.html#cb778-2" aria-hidden="true"></a>    <span class="kw">sqrt</span>((d<span class="op">$</span>x1 <span class="op">-</span><span class="st"> </span>centroids[<span class="dv">1</span>, i])<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(d<span class="op">$</span>x2 <span class="op">-</span><span class="st"> </span>centroids[<span class="dv">2</span>, i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb778-3"><a href="unsupervised-learning.html#cb778-3" aria-hidden="true"></a>})</span>
<span id="cb778-4"><a href="unsupervised-learning.html#cb778-4" aria-hidden="true"></a>d<span class="op">$</span>cluster &lt;-<span class="st"> </span><span class="kw">apply</span>(dist, <span class="dv">1</span>, which.min)</span></code></pre></div>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>Repeat (c) and (d) until the answers obtained stop changing.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="unsupervised-learning.html#cb779-1" aria-hidden="true"></a>centroids &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="cf">function</span>(i) <span class="kw">colMeans</span>(d[d<span class="op">$</span>cluster <span class="op">==</span><span class="st"> </span>i, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))</span>
<span id="cb779-2"><a href="unsupervised-learning.html#cb779-2" aria-hidden="true"></a>dist &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="cf">function</span>(i) {</span>
<span id="cb779-3"><a href="unsupervised-learning.html#cb779-3" aria-hidden="true"></a>    <span class="kw">sqrt</span>((d<span class="op">$</span>x1 <span class="op">-</span><span class="st"> </span>centroids[<span class="dv">1</span>, i])<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(d<span class="op">$</span>x2 <span class="op">-</span><span class="st"> </span>centroids[<span class="dv">2</span>, i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb779-4"><a href="unsupervised-learning.html#cb779-4" aria-hidden="true"></a>})</span>
<span id="cb779-5"><a href="unsupervised-learning.html#cb779-5" aria-hidden="true"></a>d<span class="op">$</span>cluster &lt;-<span class="st"> </span><span class="kw">apply</span>(dist, <span class="dv">1</span>, which.min)</span></code></pre></div>
<p>In this case, we get stable labels after the first iteration.</p>
<blockquote>
<ol start="6" style="list-style-type: lower-alpha">
<li>In your plot from (a), color the observations according to the cluster
labels obtained.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="unsupervised-learning.html#cb780-1" aria-hidden="true"></a><span class="kw">ggplot</span>(d, <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2, <span class="dt">color =</span> <span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="question-4-10" class="section level3 hasAnchor" number="12.1.4">
<h3><span class="header-section-number">12.1.4</span> Question 4<a href="unsupervised-learning.html#question-4-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Suppose that for a particular data set, we perform hierarchical clustering
using single linkage and using complete linkage. We obtain two dendrograms.</p>
<ol style="list-style-type: lower-alpha">
<li>At a certain point on the single linkage dendrogram, the clusters {1, 2, 3}
and {4, 5} fuse. On the complete linkage dendrogram, the clusters {1, 2, 3}
and {4, 5} also fuse at a certain point. Which fusion will occur higher on
the tree, or will they fuse at the same height, or is there not enough
information to tell?</li>
</ol>
</blockquote>
<p>The complete linkage fusion will likely be higher in the tree since single
linkage is defined as being the minimum distance between two clusters. However,
there is a chance that they could be at the same height (so technically there
is not enough information to tell).</p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>At a certain point on the single linkage dendrogram, the clusters {5} and
{6} fuse. On the complete linkage dendrogram, the clusters {5} and {6} also
fuse at a certain point. Which fusion will occur higher on the tree, or
will they fuse at the same height, or is there not enough information to
tell?</li>
</ol>
</blockquote>
<p>They will fuse at the same height (the algorithm for calculating distance is
the same when the clusters are of size 1).</p>
</div>
<div id="question-5-10" class="section level3 hasAnchor" number="12.1.5">
<h3><span class="header-section-number">12.1.5</span> Question 5<a href="unsupervised-learning.html#question-5-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In words, describe the results that you would expect if you performed
<span class="math inline">\(K\)</span>-means clustering of the eight shoppers in Figure 12.16, on the basis of
their sock and computer purchases, with <span class="math inline">\(K = 2\)</span>. Give three answers, one for
each of the variable scalings displayed. Explain.</p>
</blockquote>
<p>In cases where variables are scaled we would expect clusters to correspond
to whether or not the retainer sold a computer. In the first case (raw numbers
of items sold), we would expect clusters to represent low vs high numbers of
sock purchases.</p>
<p>To test, we can run the analysis in R:</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="unsupervised-learning.html#cb781-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb781-2"><a href="unsupervised-learning.html#cb781-2" aria-hidden="true"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb781-3"><a href="unsupervised-learning.html#cb781-3" aria-hidden="true"></a>  <span class="dt">socks =</span> <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>),</span>
<span id="cb781-4"><a href="unsupervised-learning.html#cb781-4" aria-hidden="true"></a>  <span class="dt">computers =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb781-5"><a href="unsupervised-learning.html#cb781-5" aria-hidden="true"></a>)</span>
<span id="cb781-6"><a href="unsupervised-learning.html#cb781-6" aria-hidden="true"></a><span class="kw">kmeans</span>(dat, <span class="dv">2</span>)<span class="op">$</span>cluster</span></code></pre></div>
<pre><code>## [1] 1 1 2 2 2 2 2 1</code></pre>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="unsupervised-learning.html#cb783-1" aria-hidden="true"></a><span class="kw">kmeans</span>(<span class="kw">scale</span>(dat), <span class="dv">2</span>)<span class="op">$</span>cluster</span></code></pre></div>
<pre><code>## [1] 1 1 1 1 2 2 2 2</code></pre>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="unsupervised-learning.html#cb785-1" aria-hidden="true"></a>dat<span class="op">$</span>computers &lt;-<span class="st"> </span>dat<span class="op">$</span>computers <span class="op">*</span><span class="st"> </span><span class="dv">2000</span></span>
<span id="cb785-2"><a href="unsupervised-learning.html#cb785-2" aria-hidden="true"></a><span class="kw">kmeans</span>(dat, <span class="dv">2</span>)<span class="op">$</span>cluster</span></code></pre></div>
<pre><code>## [1] 1 1 1 1 2 2 2 2</code></pre>
</div>
<div id="question-6-10" class="section level3 hasAnchor" number="12.1.6">
<h3><span class="header-section-number">12.1.6</span> Question 6<a href="unsupervised-learning.html#question-6-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We saw in Section 12.2.2 that the principal component loading and score
vectors provide an approximation to a matrix, in the sense of (12.5).
Specifically, the principal component score and loading vectors solve the
optimization problem given in (12.6).</p>
<p>Now, suppose that the M principal component score vectors zim, <span class="math inline">\(m = 1,...,M\)</span>,
are known. Using (12.6), explain that the first <span class="math inline">\(M\)</span> principal component
loading vectors <span class="math inline">\(\phi_{jm}\)</span>, <span class="math inline">\(m = 1,...,M\)</span>, can be obtaining by performing <span class="math inline">\(M\)</span>
separate least squares linear regressions. In each regression, the principal
component score vectors are the predictors, and one of the features of the
data matrix is the response.</p>
</blockquote>
</div>
</div>
<div id="applied-10" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Applied<a href="unsupervised-learning.html#applied-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-7-10" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Question 7<a href="unsupervised-learning.html#question-7-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In the chapter, we mentioned the use of correlation-based distance and
Euclidean distance as dissimilarity measures for hierarchical clustering.
It turns out that these two measures are almost equivalent: if each
observation has been centered to have mean zero and standard deviation one,
and if we let <span class="math inline">\(r_{ij}\)</span> denote the correlation between the <span class="math inline">\(i\)</span>th and <span class="math inline">\(j\)</span>th
observations, then the quantity <span class="math inline">\(1 − r_{ij}\)</span> is proportional to the squared
Euclidean distance between the ith and jth observations.</p>
<p>On the <code>USArrests</code> data, show that this proportionality holds.</p>
<p><em>Hint: The Euclidean distance can be calculated using the <code>dist()</code> function,</em>
<em>and correlations can be calculated using the <code>cor()</code> function.</em></p>
</blockquote>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="unsupervised-learning.html#cb787-1" aria-hidden="true"></a>dat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">scale</span>(<span class="kw">t</span>(USArrests)))</span>
<span id="cb787-2"><a href="unsupervised-learning.html#cb787-2" aria-hidden="true"></a>d1 &lt;-<span class="st"> </span><span class="kw">dist</span>(dat)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb787-3"><a href="unsupervised-learning.html#cb787-3" aria-hidden="true"></a>d2 &lt;-<span class="st"> </span><span class="kw">as.dist</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(<span class="kw">t</span>(dat)))</span>
<span id="cb787-4"><a href="unsupervised-learning.html#cb787-4" aria-hidden="true"></a><span class="kw">plot</span>(d1, d2)</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="question-8-10" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Question 8<a href="unsupervised-learning.html#question-8-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In Section 12.2.3, a formula for calculating PVE was given in Equation
12.10. We also saw that the PVE can be obtained using the <code>sdev</code> output of the
<code>prcomp()</code> function.</p>
<p>On the <code>USArrests</code> data, calculate PVE in two ways:</p>
<ol style="list-style-type: lower-alpha">
<li>Using the <code>sdev</code> output of the <code>prcomp()</code> function, as was done in Section
12.2.3.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="unsupervised-learning.html#cb788-1" aria-hidden="true"></a>pr &lt;-<span class="st"> </span><span class="kw">prcomp</span>(USArrests, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</span>
<span id="cb788-2"><a href="unsupervised-learning.html#cb788-2" aria-hidden="true"></a>pr<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(pr<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.62006039 0.24744129 0.08914080 0.04335752</code></pre>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>By applying Equation 12.10 directly. That is, use the <code>prcomp()</code> function to
compute the principal component loadings. Then, use those loadings in
Equation 12.10 to obtain the PVE.</li>
</ol>
<p>These two approaches should give the same results.</p>
</blockquote>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="unsupervised-learning.html#cb790-1" aria-hidden="true"></a><span class="kw">colSums</span>(pr<span class="op">$</span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">colSums</span>(<span class="kw">scale</span>(USArrests)<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        PC1        PC2        PC3        PC4 
## 0.62006039 0.24744129 0.08914080 0.04335752</code></pre>
<blockquote>
<p><em>Hint: You will only obtain the same results in (a) and (b) if the same</em>
<em>data is used in both cases. For instance, if in (a) you performed</em>
<em><code>prcomp()</code> using centered and scaled variables, then you must center and</em>
<em>scale the variables before applying Equation 12.10 in (b).</em></p>
</blockquote>
</div>
<div id="question-9-9" class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> Question 9<a href="unsupervised-learning.html#question-9-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Consider the <code>USArrests</code> data. We will now perform hierarchical clustering on
the states.</p>
<ol style="list-style-type: lower-alpha">
<li>Using hierarchical clustering with complete linkage and Euclidean distance,
cluster the states.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="unsupervised-learning.html#cb792-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb792-2"><a href="unsupervised-learning.html#cb792-2" aria-hidden="true"></a>hc &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(USArrests), <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Cut the dendrogram at a height that results in three distinct clusters.
Which states belong to which clusters?</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="unsupervised-learning.html#cb793-1" aria-hidden="true"></a>ct &lt;-<span class="st"> </span><span class="kw">cutree</span>(hc, <span class="dv">3</span>)</span>
<span id="cb793-2"><a href="unsupervised-learning.html#cb793-2" aria-hidden="true"></a><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="cf">function</span>(i) <span class="kw">names</span>(ct)[ct <span class="op">==</span><span class="st"> </span>i])</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;Alabama&quot;        &quot;Alaska&quot;         &quot;Arizona&quot;        &quot;California&quot;    
##  [5] &quot;Delaware&quot;       &quot;Florida&quot;        &quot;Illinois&quot;       &quot;Louisiana&quot;     
##  [9] &quot;Maryland&quot;       &quot;Michigan&quot;       &quot;Mississippi&quot;    &quot;Nevada&quot;        
## [13] &quot;New Mexico&quot;     &quot;New York&quot;       &quot;North Carolina&quot; &quot;South Carolina&quot;
## 
## [[2]]
##  [1] &quot;Arkansas&quot;      &quot;Colorado&quot;      &quot;Georgia&quot;       &quot;Massachusetts&quot;
##  [5] &quot;Missouri&quot;      &quot;New Jersey&quot;    &quot;Oklahoma&quot;      &quot;Oregon&quot;       
##  [9] &quot;Rhode Island&quot;  &quot;Tennessee&quot;     &quot;Texas&quot;         &quot;Virginia&quot;     
## [13] &quot;Washington&quot;    &quot;Wyoming&quot;      
## 
## [[3]]
##  [1] &quot;Connecticut&quot;   &quot;Hawaii&quot;        &quot;Idaho&quot;         &quot;Indiana&quot;      
##  [5] &quot;Iowa&quot;          &quot;Kansas&quot;        &quot;Kentucky&quot;      &quot;Maine&quot;        
##  [9] &quot;Minnesota&quot;     &quot;Montana&quot;       &quot;Nebraska&quot;      &quot;New Hampshire&quot;
## [13] &quot;North Dakota&quot;  &quot;Ohio&quot;          &quot;Pennsylvania&quot;  &quot;South Dakota&quot; 
## [17] &quot;Utah&quot;          &quot;Vermont&quot;       &quot;West Virginia&quot; &quot;Wisconsin&quot;</code></pre>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Hierarchically cluster the states using complete linkage and Euclidean
distance, <em>after scaling the variables to have standard deviation one</em>.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="unsupervised-learning.html#cb795-1" aria-hidden="true"></a>hc2 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(<span class="kw">scale</span>(USArrests)), <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>What effect does scaling the variables have on the hierarchical clustering
obtained? In your opinion, should the variables be scaled before the
inter-observation dissimilarities are computed? Provide a justification for
your answer.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="unsupervised-learning.html#cb796-1" aria-hidden="true"></a>ct &lt;-<span class="st"> </span><span class="kw">cutree</span>(hc, <span class="dv">3</span>)</span>
<span id="cb796-2"><a href="unsupervised-learning.html#cb796-2" aria-hidden="true"></a><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="cf">function</span>(i) <span class="kw">names</span>(ct)[ct <span class="op">==</span><span class="st"> </span>i])</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;Alabama&quot;        &quot;Alaska&quot;         &quot;Arizona&quot;        &quot;California&quot;    
##  [5] &quot;Delaware&quot;       &quot;Florida&quot;        &quot;Illinois&quot;       &quot;Louisiana&quot;     
##  [9] &quot;Maryland&quot;       &quot;Michigan&quot;       &quot;Mississippi&quot;    &quot;Nevada&quot;        
## [13] &quot;New Mexico&quot;     &quot;New York&quot;       &quot;North Carolina&quot; &quot;South Carolina&quot;
## 
## [[2]]
##  [1] &quot;Arkansas&quot;      &quot;Colorado&quot;      &quot;Georgia&quot;       &quot;Massachusetts&quot;
##  [5] &quot;Missouri&quot;      &quot;New Jersey&quot;    &quot;Oklahoma&quot;      &quot;Oregon&quot;       
##  [9] &quot;Rhode Island&quot;  &quot;Tennessee&quot;     &quot;Texas&quot;         &quot;Virginia&quot;     
## [13] &quot;Washington&quot;    &quot;Wyoming&quot;      
## 
## [[3]]
##  [1] &quot;Connecticut&quot;   &quot;Hawaii&quot;        &quot;Idaho&quot;         &quot;Indiana&quot;      
##  [5] &quot;Iowa&quot;          &quot;Kansas&quot;        &quot;Kentucky&quot;      &quot;Maine&quot;        
##  [9] &quot;Minnesota&quot;     &quot;Montana&quot;       &quot;Nebraska&quot;      &quot;New Hampshire&quot;
## [13] &quot;North Dakota&quot;  &quot;Ohio&quot;          &quot;Pennsylvania&quot;  &quot;South Dakota&quot; 
## [17] &quot;Utah&quot;          &quot;Vermont&quot;       &quot;West Virginia&quot; &quot;Wisconsin&quot;</code></pre>
<p>Scaling results in different clusters and the choice of whether to scale or
not depends on the data in question. In this case, the variables are:</p>
<ul>
<li>Murder numeric Murder arrests (per 100,000)<br />
</li>
<li>Assault numeric Assault arrests (per 100,000)</li>
<li>UrbanPop numeric Percent urban population<br />
</li>
<li>Rape numeric Rape arrests (per 100,000)</li>
</ul>
<p>These variables are not naturally on the same unit and the units involved are
somewhat arbitrary (so for example, Murder could be measured per 1 million
rather than per 100,000) so in this case I would argue the data should be
scaled.</p>
</div>
<div id="question-10-8" class="section level3 hasAnchor" number="12.2.4">
<h3><span class="header-section-number">12.2.4</span> Question 10<a href="unsupervised-learning.html#question-10-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In this problem, you will generate simulated data, and then perform PCA and
<span class="math inline">\(K\)</span>-means clustering on the data.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generate a simulated data set with 20 observations in each of three classes
(i.e. 60 observations total), and 50 variables.</p>
<p><em>Hint: There are a number of functions in <code>R</code> that you can use to generate</em>
<em>data. One example is the <code>rnorm()</code> function; <code>runif()</code> is another option.</em>
<em>Be sure to add a mean shift to the observations in each class so that</em>
<em>there are three distinct classes.</em></p></li>
</ol>
</blockquote>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="unsupervised-learning.html#cb798-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb798-2"><a href="unsupervised-learning.html#cb798-2" aria-hidden="true"></a>data &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">60</span> <span class="op">*</span><span class="st"> </span><span class="dv">50</span>), <span class="dt">ncol =</span> <span class="dv">50</span>)</span>
<span id="cb798-3"><a href="unsupervised-learning.html#cb798-3" aria-hidden="true"></a>classes &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">each =</span> <span class="dv">20</span>)</span>
<span id="cb798-4"><a href="unsupervised-learning.html#cb798-4" aria-hidden="true"></a><span class="kw">dimnames</span>(data) &lt;-<span class="st"> </span><span class="kw">list</span>(classes, <span class="kw">paste0</span>(<span class="st">&quot;v&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>))</span>
<span id="cb798-5"><a href="unsupervised-learning.html#cb798-5" aria-hidden="true"></a>data[classes <span class="op">==</span><span class="st"> &quot;B&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] &lt;-<span class="st"> </span>data[classes <span class="op">==</span><span class="st"> &quot;B&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] <span class="op">+</span><span class="st"> </span><span class="fl">1.2</span></span>
<span id="cb798-6"><a href="unsupervised-learning.html#cb798-6" aria-hidden="true"></a>data[classes <span class="op">==</span><span class="st"> &quot;C&quot;</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">30</span>] &lt;-<span class="st"> </span>data[classes <span class="op">==</span><span class="st"> &quot;C&quot;</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">30</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span></code></pre></div>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Perform PCA on the 60 observations and plot the first two principal
component score vectors. Use a different color to indicate the
observations in each of the three classes. If the three classes appear
separated in this plot, then continue on to part (c). If not, then return
to part (a) and modify the simulation so that there is greater separation
between the three classes. Do not continue to part (c) until the three
classes show at least some separation in the first two principal component
score vectors.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="unsupervised-learning.html#cb799-1" aria-hidden="true"></a>pca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(data)</span>
<span id="cb799-2"><a href="unsupervised-learning.html#cb799-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">Class =</span> classes, <span class="dt">PC1 =</span> pca<span class="op">$</span>x[, <span class="dv">1</span>], <span class="dt">PC2 =</span> pca<span class="op">$</span>x[, <span class="dv">2</span>]),</span>
<span id="cb799-3"><a href="unsupervised-learning.html#cb799-3" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> PC1, <span class="dt">y =</span> PC2, <span class="dt">col =</span> Class)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb799-4"><a href="unsupervised-learning.html#cb799-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Perform <span class="math inline">\(K\)</span>-means clustering of the observations with <span class="math inline">\(K = 3\)</span>. How well do
the clusters that you obtained in <span class="math inline">\(K\)</span>-means clustering compare to the true
class labels?</p>
<p><em>Hint: You can use the <code>table()</code> function in <code>R</code> to compare the true class</em>
<em>labels to the class labels obtained by clustering. Be careful how you</em>
<em>interpret the results: <span class="math inline">\(K\)</span>-means clustering will arbitrarily number the</em>
<em>clusters, so you cannot simply check whether the true class labels and</em>
<em>clustering labels are the same.</em></p></li>
</ol>
</blockquote>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="unsupervised-learning.html#cb800-1" aria-hidden="true"></a>km &lt;-<span class="st"> </span><span class="kw">kmeans</span>(data, <span class="dv">3</span>)<span class="op">$</span>cluster</span>
<span id="cb800-2"><a href="unsupervised-learning.html#cb800-2" aria-hidden="true"></a><span class="kw">table</span>(km, <span class="kw">names</span>(km))</span></code></pre></div>
<pre><code>##    
## km   A  B  C
##   1  1 20  1
##   2  0  0 19
##   3 19  0  0</code></pre>
<p><span class="math inline">\(K\)</span>-means separates out the clusters nearly perfectly.</p>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Perform <span class="math inline">\(K\)</span>-means clustering with <span class="math inline">\(K = 2\)</span>. Describe your results.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="unsupervised-learning.html#cb802-1" aria-hidden="true"></a>km &lt;-<span class="st"> </span><span class="kw">kmeans</span>(data, <span class="dv">2</span>)<span class="op">$</span>cluster</span>
<span id="cb802-2"><a href="unsupervised-learning.html#cb802-2" aria-hidden="true"></a><span class="kw">table</span>(km, <span class="kw">names</span>(km))</span></code></pre></div>
<pre><code>##    
## km   A  B  C
##   1 18 20  1
##   2  2  0 19</code></pre>
<p><span class="math inline">\(K\)</span>-means effectively defines cluster 2 to be class B, but cluster 1 is a mix
of classes A and B.</p>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>Now perform <span class="math inline">\(K\)</span>-means clustering with <span class="math inline">\(K = 4\)</span>, and describe your results.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="unsupervised-learning.html#cb804-1" aria-hidden="true"></a>km &lt;-<span class="st"> </span><span class="kw">kmeans</span>(data, <span class="dv">4</span>)<span class="op">$</span>cluster</span>
<span id="cb804-2"><a href="unsupervised-learning.html#cb804-2" aria-hidden="true"></a><span class="kw">table</span>(km, <span class="kw">names</span>(km))</span></code></pre></div>
<pre><code>##    
## km   A  B  C
##   1  0  7  2
##   2 18  1  0
##   3  0  0 18
##   4  2 12  0</code></pre>
<p><span class="math inline">\(K\)</span>-means effectively defines cluster 1 to be class B, cluster 2 to be class A
but clusters 3 and 4 are split over class C.</p>
<blockquote>
<ol start="6" style="list-style-type: lower-alpha">
<li>Now perform <span class="math inline">\(K\)</span>-means clustering with <span class="math inline">\(K = 3\)</span> on the first two principal
component score vectors, rather than on the raw data. That is, perform
<span class="math inline">\(K\)</span>-means clustering on the <span class="math inline">\(60 \times 2\)</span> matrix of which the first column
is the first principal component score vector, and the second column is
the second principal component score vector. Comment on the results.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="unsupervised-learning.html#cb806-1" aria-hidden="true"></a>km &lt;-<span class="st"> </span><span class="kw">kmeans</span>(pca<span class="op">$</span>x[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">3</span>)<span class="op">$</span>cluster</span>
<span id="cb806-2"><a href="unsupervised-learning.html#cb806-2" aria-hidden="true"></a><span class="kw">table</span>(km, <span class="kw">names</span>(km))</span></code></pre></div>
<pre><code>##    
## km   A  B  C
##   1  0 20  2
##   2 20  0  0
##   3  0  0 18</code></pre>
<p><span class="math inline">\(K\)</span>-means again separates out the clusters nearly perfectly.</p>
<blockquote>
<ol start="7" style="list-style-type: lower-alpha">
<li>Using the <code>scale()</code> function, perform <span class="math inline">\(K\)</span>-means clustering with <span class="math inline">\(K = 3\)</span> on
the data <em>after scaling each variable to have standard deviation one</em>. How
do these results compare to those obtained in (b)? Explain.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="unsupervised-learning.html#cb808-1" aria-hidden="true"></a>km &lt;-<span class="st"> </span><span class="kw">kmeans</span>(<span class="kw">scale</span>(data), <span class="dv">3</span>)<span class="op">$</span>cluster</span>
<span id="cb808-2"><a href="unsupervised-learning.html#cb808-2" aria-hidden="true"></a><span class="kw">table</span>(km, <span class="kw">names</span>(km))</span></code></pre></div>
<pre><code>##    
## km   A  B  C
##   1  1 20  1
##   2 19  0  0
##   3  0  0 19</code></pre>
<p><span class="math inline">\(K\)</span>-means appears to perform less well on the scaled data in this case.</p>
</div>
<div id="question-11-7" class="section level3 hasAnchor" number="12.2.5">
<h3><span class="header-section-number">12.2.5</span> Question 11<a href="unsupervised-learning.html#question-11-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Write an <code>R</code> function to perform matrix completion as in Algorithm 12.1, and
as outlined in Section 12.5.2. In each iteration, the function should keep
track of the relative error, as well as the iteration count. Iterations should
continue until the relative error is small enough or until some maximum number
of iterations is reached (set a default value for this maximum number).
Furthermore, there should be an option to print out the progress in each
iteration.</p>
<p>Test your function on the <code>Boston</code> data. First, standardize the features to
have mean zero and standard deviation one using the <code>scale()</code> function. Run an
experiment where you randomly leave out an increasing (and nested) number of
observations from 5% to 30%, in steps of 5%. Apply Algorithm 12.1 with <span class="math inline">\(M = 1,2,...,8\)</span>. Display the approximation error as a function of the fraction of
observations that are missing, and the value of <span class="math inline">\(M\)</span>, averaged over 10
repetitions of the experiment.</p>
</blockquote>
</div>
<div id="question-12-5" class="section level3 hasAnchor" number="12.2.6">
<h3><span class="header-section-number">12.2.6</span> Question 12<a href="unsupervised-learning.html#question-12-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In Section 12.5.2, Algorithm 12.1 was implemented using the <code>svd()</code> function.
However, given the connection between the <code>svd()</code> function and the <code>prcomp()</code>
function highlighted in the lab, we could have instead implemented the
algorithm using <code>prcomp()</code>.</p>
<p>Write a function to implement Algorithm 12.1 that makes use of <code>prcomp()</code>
rather than <code>svd()</code>.</p>
</blockquote>
</div>
<div id="question-13-4" class="section level3 hasAnchor" number="12.2.7">
<h3><span class="header-section-number">12.2.7</span> Question 13<a href="unsupervised-learning.html#question-13-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>On the book website, <code>www.StatLearning.com</code>, there is a gene expression data
set (<code>Ch12Ex13.csv</code>) that consists of 40 tissue samples with measurements on
1,000 genes. The first 20 samples are from healthy patients, while the
second 20 are from a diseased group.</p>
<ol style="list-style-type: lower-alpha">
<li>Load in the data using <code>read.csv()</code>. You will need to select <code>header = F</code>.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="unsupervised-learning.html#cb810-1" aria-hidden="true"></a>data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Ch12Ex13.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)</span>
<span id="cb810-2"><a href="unsupervised-learning.html#cb810-2" aria-hidden="true"></a><span class="kw">colnames</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;H&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>), <span class="kw">paste0</span>(<span class="st">&quot;D&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>))</span></code></pre></div>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Apply hierarchical clustering to the samples using correlation-based
distance, and plot the dendrogram. Do the genes separate the samples into
the two groups? Do your results depend on the type of linkage used?</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="unsupervised-learning.html#cb811-1" aria-hidden="true"></a>hc.complete &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">as.dist</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(data)), <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb811-2"><a href="unsupervised-learning.html#cb811-2" aria-hidden="true"></a><span class="kw">plot</span>(hc.complete)</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="unsupervised-learning.html#cb812-1" aria-hidden="true"></a>hc.complete &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">as.dist</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(data)), <span class="dt">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb812-2"><a href="unsupervised-learning.html#cb812-2" aria-hidden="true"></a><span class="kw">plot</span>(hc.complete)</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="unsupervised-learning.html#cb813-1" aria-hidden="true"></a>hc.complete &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">as.dist</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(data)), <span class="dt">method =</span> <span class="st">&quot;single&quot;</span>)</span>
<span id="cb813-2"><a href="unsupervised-learning.html#cb813-2" aria-hidden="true"></a><span class="kw">plot</span>(hc.complete)</span></code></pre></div>
<p><img src="12-unsupervised-learning_files/figure-html/unnamed-chunk-28-3.png" width="672" /></p>
<p>Yes the samples clearly separate into the two groups, although the results
depend somewhat on the linkage method used. In the case of average clustering,
the disease samples all fall within a subset of the healthy samples.</p>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Your collaborator wants to know which genes differ the most across the two
groups. Suggest a way to answer this question, and apply it here.</li>
</ol>
</blockquote>
<p>This is probably best achieved with a supervised approach. A simple method
would be to determine which genes show the most significant differences between
the groups by applying a t-test to each group. We can then select those with a
FDR adjusted p-value less than some given threshold (e.g. 0.05).</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="unsupervised-learning.html#cb814-1" aria-hidden="true"></a>class &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Healthy&quot;</span>, <span class="st">&quot;Diseased&quot;</span>), <span class="dt">each =</span> <span class="dv">20</span>))</span>
<span id="cb814-2"><a href="unsupervised-learning.html#cb814-2" aria-hidden="true"></a>pvals &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(<span class="kw">apply</span>(data, <span class="dv">1</span>, <span class="cf">function</span>(v) <span class="kw">t.test</span>(v <span class="op">~</span><span class="st"> </span>class)<span class="op">$</span>p.value))</span>
<span id="cb814-3"><a href="unsupervised-learning.html#cb814-3" aria-hidden="true"></a><span class="kw">which</span>(pvals <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>##   [1]  11  12  13  14  15  16  17  18  19  20 501 502 503 504 505 506 507 508
##  [19] 509 511 512 513 514 515 516 517 519 520 521 522 523 524 525 526 527 528
##  [37] 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546
##  [55] 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564
##  [73] 565 566 567 568 569 570 571 572 574 575 576 577 578 579 580 581 582 583
##  [91] 584 586 587 588 589 590 591 592 593 595 596 597 598 599 600</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="survival-analysis-and-censored-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/danhalligan/ISLRv2-solutions/edit/main/12-unsupervised-learning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
